<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>caching</title>
    <script src="../jquery.1.11.1.js"></script>
    <script>

        $(function () {
            
            var cache = {}

            $.ajaxSetup({
                url: "http://edu.cbsystematics.com/temp/article.ashx",
                type: "GET"
            });

            function onSuccess(response, status, xhr) {
                $("#output").html(response);
            }

            function onError(xhr, status, errorThrown) {
                $("#output").html(errorThrown);
            }

            function onComplete(xhr, status, errorThrown) {
                $("#loading").hide();
            }

            $("#btn").click(function () {

                var selectedId = $("#a").val();

                if (!cache[selectedId]) {
                    $("#loading").show();
                    cache[selectedId] = $.ajax({ data: { id: selectedId } });
                }

                cache[selectedId].done(onSuccess).fail(onError).always(onComplete);
            });
        });
    </script>

</head>
<body>
    <input id="a" type="text" value="0" />
    <button id="btn">Read</button>
    <span id="loading" style="display:none;">Loading</span>
    <p id="output"></p>

    
</body>
</html>
